<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Liste des événements</title>
    <style>
        body { font-family: DejaVu Sans, Arial, sans-serif; font-size: 12px; color: #222; }
        h1 { margin: 0 0 8px; font-size: 22px; }
        .meta { margin-bottom: 14px; color: #555; }
        table { width: 100%; border-collapse: collapse; margin-top: 8px; }
        th, td { border: 1px solid #ddd; padding: 6px 8px; vertical-align: top; }
        th { background: #f2f4f7; text-align: left; }
        .muted { color: #666; }
    </style>
</head>
<body>
    <h1>Liste des événements</h1>
    <div class="meta">
        Généré le {{ generated|date('d/m/Y H:i') }}<br>
        Total: {{ evenements|length }} événement(s)
    </div>

    <table>
        <thead>
            <tr>
                <th>ID</th>
                <th>Titre</th>
                <th>Type</th>
                <th>Date début</th>
                <th>Lieu</th>
                <th>Statut</th>
                <th>Visibilité</th>
                <th>Participants</th>
            </tr>
        </thead>
        <tbody>
        {% for evenement in evenements %}
            <tr>
                <td>#{{ evenement.id }}</td>
                <td>
                    {{ evenement.titre }}
                    {% if evenement.description %}
                        <div class="muted">{{ evenement.description|slice(0, 70) }}{{ evenement.description|length > 70 ? '...' : '' }}</div>
                    {% endif %}
                </td>
                <td>{{ evenement.typeEvenement.value|capitalize }}</td>
                <td>{{ evenement.dateDebut ? evenement.dateDebut|date('d/m/Y H:i') : '-' }}</td>
                <td>{{ evenement.lieu|default('-') }}</td>
                <td>{{ evenement.statut.value|capitalize }}</td>
                <td>{{ evenement.visibilite.value|replace({'_': ' '})|capitalize }}</td>
                <td>{{ participation_counts[evenement.id]|default(0) }}</td>
            </tr>
        {% else %}
            <tr>
                <td colspan="8">Aucun événement trouvé.</td>
            </tr>
        {% endfor %}
        </tbody>
    </table>
</body>
</html>
